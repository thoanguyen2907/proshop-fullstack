{"ast":null,"code":"var _jsxFileName = \"/Users/thoanguyen/Library/Mobile Documents/com~apple~CloudDocs/fullstack/proshop/frontend/src/screens/OrderScreen.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { NavLink } from 'react-router-dom';\nimport CheckoutSteps from '../components/CheckoutSteps';\nimport { createOrder, deliverOrder, getOrderDetail, payOrder } from '../redux/actions/orderAction';\nimport { history } from '../utils/history/history';\nimport axios from 'axios';\nimport { PayPalButton } from \"react-paypal-button-v2\";\nimport { ORDER_PAY_RESET } from '../redux/constants/constants';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function OrderScreen(_ref) {\n  _s();\n\n  var _order$user, _order$user2, _order$user3;\n\n  let {\n    match\n  } = _ref;\n  const dispatch = useDispatch();\n  const orderId = match.params.id;\n  const orderDetail = useSelector(state => state.orderDetail);\n  const orderDeliver = useSelector(state => state.orderDeliver);\n  const {\n    loading: loadingDeliver,\n    success: successDeliver\n  } = orderDeliver;\n  const userLogin = useSelector(state => state.userLogin);\n  const {\n    userInfo\n  } = userLogin;\n  const [sdkReady, setSdkReady] = useState(false);\n  const {\n    order,\n    loading\n  } = orderDetail;\n  const orderPay = useSelector(state => state.orderPay);\n  const {\n    loading: loadingPay,\n    success: successPay\n  } = orderPay;\n\n  const deliverHandler = () => {\n    dispatch(deliverOrder(order));\n  };\n\n  useEffect(() => {\n    const addPayPalScript = async () => {\n      const {\n        data: clientId\n      } = await axios.get('http://localhost:5000/api/config/paypal');\n      console.log(clientId);\n      const script = document.createElement('script');\n      script.type = \"text/javascript\";\n      script.async = true;\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`;\n\n      script.onload = () => {\n        setSdkReady(true);\n      };\n\n      document.body.appendChild(script);\n    };\n\n    if (!order || successPay) {\n      dispatch({\n        type: ORDER_PAY_RESET\n      });\n      dispatch(getOrderDetail(orderId));\n    } else if (!order.isPaid) {\n      if (!window.paypal) {\n        addPayPalScript();\n      } else {\n        setSdkReady(true);\n      }\n    }\n  }, [dispatch, orderId, successPay, order]);\n\n  const successPaymentHandler = paymentResult => {\n    console.log(paymentResult);\n    dispatch(payOrder(orderId, paymentResult));\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(CheckoutSteps, {\n      step1: true,\n      step2: true,\n      step3: true,\n      step4: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this), \"OrderScreen\", /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: [\"Order \", order === null || order === void 0 ? void 0 : order._id]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-8\",\n        children: /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"list-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"list-group-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"Shipping\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 75,\n              columnNumber: 23\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Name : \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 77,\n                columnNumber: 27\n              }, this), \" \", order === null || order === void 0 ? void 0 : (_order$user = order.user) === null || _order$user === void 0 ? void 0 : _order$user.name]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 76,\n              columnNumber: 23\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Email: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 80,\n                columnNumber: 27\n              }, this), \" \", ' ', /*#__PURE__*/_jsxDEV(\"a\", {\n                href: `mailto: ${order === null || order === void 0 ? void 0 : (_order$user2 = order.user) === null || _order$user2 === void 0 ? void 0 : _order$user2.email}`,\n                children: order === null || order === void 0 ? void 0 : (_order$user3 = order.user) === null || _order$user3 === void 0 ? void 0 : _order$user3.email\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 81,\n                columnNumber: 25\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 79,\n              columnNumber: 23\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Address:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 84,\n                columnNumber: 17\n              }, this), order === null || order === void 0 ? void 0 : order.shippingAddress.address, \", \", order === null || order === void 0 ? void 0 : order.shippingAddress.city, ' ', order === null || order === void 0 ? void 0 : order.shippingAddress.postalCode, \",\", ' ', order === null || order === void 0 ? void 0 : order.shippingAddress.country]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 83,\n              columnNumber: 23\n            }, this), order !== null && order !== void 0 && order.isDelivered ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-danger\",\n              children: [\"Delivered on \", order === null || order === void 0 ? void 0 : order.deliveredAt]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 90,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-danger\",\n              children: \"Not Delivered\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"list-group-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"Payment Method\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Method: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 102,\n                columnNumber: 17\n              }, this), order === null || order === void 0 ? void 0 : order.paymentMethod]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 101,\n              columnNumber: 15\n            }, this), order !== null && order !== void 0 && order.isPaid ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-danger\",\n              children: [\"Paid on \", order.paidAt]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 106,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-danger\",\n              children: \"Not Paid\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"list-group-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"Order Items\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 19\n            }, this), (order === null || order === void 0 ? void 0 : order.orderItems.length) === 0 ? /*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"Order is empty\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"list-group\",\n              children: order === null || order === void 0 ? void 0 : order.orderItems.map((item, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n                className: \"list-group-item\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"row\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col\",\n                    children: /*#__PURE__*/_jsxDEV(\"img\", {\n                      style: {\n                        width: \"50px\",\n                        height: \"50px\"\n                      },\n                      src: item === null || item === void 0 ? void 0 : item.image,\n                      alt: item === null || item === void 0 ? void 0 : item.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 122,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 121,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col\",\n                    children: /*#__PURE__*/_jsxDEV(NavLink, {\n                      to: `/product/${item === null || item === void 0 ? void 0 : item.product}`,\n                      children: item === null || item === void 0 ? void 0 : item.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 129,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 128,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-4\",\n                    children: [item === null || item === void 0 ? void 0 : item.quantity, \" x $\", item === null || item === void 0 ? void 0 : item.price, \" = $\", (item === null || item === void 0 ? void 0 : item.quantity) * (item === null || item === void 0 ? void 0 : item.price)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 133,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 120,\n                  columnNumber: 23\n                }, this)\n              }, index, false, {\n                fileName: _jsxFileName,\n                lineNumber: 119,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card\",\n          children: /*#__PURE__*/_jsxDEV(\"ul\", {\n            children: [/*#__PURE__*/_jsxDEV(\"li\", {\n              children: /*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"Order Summary\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"row\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"col\",\n                  children: \"Items\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 152,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"col\",\n                  children: [\"$\", order === null || order === void 0 ? void 0 : order.itemsPrice]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 153,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"row\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"col\",\n                  children: \"Shipping\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 158,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"col\",\n                  children: [\"$\", order === null || order === void 0 ? void 0 : order.shippingPrice]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 159,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 157,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"row\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"col\",\n                  children: \"Tax\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 164,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"col\",\n                  children: [\"$\", order === null || order === void 0 ? void 0 : order.taxPrice]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 165,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 163,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"row\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"col\",\n                  children: \"Total\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 170,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"col\",\n                  children: [\"$\", order === null || order === void 0 ? void 0 : order.totalPrice]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 171,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 169,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 168,\n              columnNumber: 15\n            }, this), !(order !== null && order !== void 0 && order.isPaid) && /*#__PURE__*/_jsxDEV(\"li\", {\n              children: [loadingPay && /*#__PURE__*/_jsxDEV(\"h1\", {\n                children: \"Loading ...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 176,\n                columnNumber: 38\n              }, this), loadingPay ? /*#__PURE__*/_jsxDEV(\"h1\", {\n                children: \"Loading ...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 177,\n                columnNumber: 37\n              }, this) : /*#__PURE__*/_jsxDEV(PayPalButton, {\n                amount: order === null || order === void 0 ? void 0 : order.totalPrice,\n                onSuccess: successPaymentHandler\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 178,\n                columnNumber: 27\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 175,\n              columnNumber: 19\n            }, this), loadingDeliver && /*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"Loading ...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 183,\n              columnNumber: 20\n            }, this), userInfo && (userInfo === null || userInfo === void 0 ? void 0 : userInfo.isAdmin) && !(order !== null && order !== void 0 && order.isPaid) && !(order !== null && order !== void 0 && order.isDelivered) && /*#__PURE__*/_jsxDEV(\"li\", {\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"btn btn-dark\",\n                onClick: deliverHandler,\n                children: \"Mark As Delivered\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 189,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 10\n  }, this);\n}\n\n_s(OrderScreen, \"mnnC7nV9PMMbHp8mjMlNDyh90Uw=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = OrderScreen;\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderScreen\");","map":{"version":3,"sources":["/Users/thoanguyen/Library/Mobile Documents/com~apple~CloudDocs/fullstack/proshop/frontend/src/screens/OrderScreen.js"],"names":["React","useEffect","useState","useDispatch","useSelector","NavLink","CheckoutSteps","createOrder","deliverOrder","getOrderDetail","payOrder","history","axios","PayPalButton","ORDER_PAY_RESET","OrderScreen","match","dispatch","orderId","params","id","orderDetail","state","orderDeliver","loading","loadingDeliver","success","successDeliver","userLogin","userInfo","sdkReady","setSdkReady","order","orderPay","loadingPay","successPay","deliverHandler","addPayPalScript","data","clientId","get","console","log","script","document","createElement","type","async","src","onload","body","appendChild","isPaid","window","paypal","successPaymentHandler","paymentResult","_id","user","name","email","shippingAddress","address","city","postalCode","country","isDelivered","deliveredAt","paymentMethod","paidAt","orderItems","length","map","item","index","width","height","image","product","quantity","price","itemsPrice","shippingPrice","taxPrice","totalPrice","isAdmin"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SAASC,OAAT,QAAwB,kBAAxB;AACA,OAAOC,aAAP,MAA0B,6BAA1B;AACA,SAASC,WAAT,EAAsBC,YAAtB,EAAoCC,cAApC,EAAoDC,QAApD,QAAoE,8BAApE;AACA,SAASC,OAAT,QAAwB,0BAAxB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,YAAT,QAA6B,wBAA7B;AACA,SAASC,eAAT,QAAgC,8BAAhC;;AAEA,eAAe,SAASC,WAAT,OAA8B;AAAA;;AAAA;;AAAA,MAAT;AAACC,IAAAA;AAAD,GAAS;AAEzC,QAAMC,QAAQ,GAAGd,WAAW,EAA5B;AACA,QAAMe,OAAO,GAAGF,KAAK,CAACG,MAAN,CAAaC,EAA7B;AACA,QAAMC,WAAW,GAAGjB,WAAW,CAACkB,KAAK,IAAIA,KAAK,CAACD,WAAhB,CAA/B;AAEA,QAAME,YAAY,GAAGnB,WAAW,CAAEkB,KAAD,IAAWA,KAAK,CAACC,YAAlB,CAAhC;AACF,QAAM;AAAEC,IAAAA,OAAO,EAAEC,cAAX;AAA2BC,IAAAA,OAAO,EAAEC;AAApC,MAAuDJ,YAA7D;AAEA,QAAMK,SAAS,GAAGxB,WAAW,CAAEkB,KAAD,IAAWA,KAAK,CAACM,SAAlB,CAA7B;AACA,QAAM;AAAEC,IAAAA;AAAF,MAAeD,SAArB;AAEE,QAAM,CAACE,QAAD,EAAWC,WAAX,IAA0B7B,QAAQ,CAAC,KAAD,CAAxC;AACA,QAAM;AAAC8B,IAAAA,KAAD;AAAQR,IAAAA;AAAR,MAAoBH,WAA1B;AAEA,QAAMY,QAAQ,GAAG7B,WAAW,CAACkB,KAAK,IAAIA,KAAK,CAACW,QAAhB,CAA5B;AAGA,QAAM;AAACT,IAAAA,OAAO,EAACU,UAAT;AAAqBR,IAAAA,OAAO,EAACS;AAA7B,MAA4CF,QAAlD;;AAEA,QAAMG,cAAc,GAAG,MAAM;AAC3BnB,IAAAA,QAAQ,CAACT,YAAY,CAACwB,KAAD,CAAb,CAAR;AACD,GAFD;;AAIA/B,EAAAA,SAAS,CAAC,MAAM;AACZ,UAAMoC,eAAe,GAAG,YAAY;AAChC,YAAM;AAACC,QAAAA,IAAI,EAAEC;AAAP,UAAmB,MAAM3B,KAAK,CAAC4B,GAAN,CAAU,yCAAV,CAA/B;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAYH,QAAZ;AACA,YAAMI,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf;AACAF,MAAAA,MAAM,CAACG,IAAP,GAAc,iBAAd;AACAH,MAAAA,MAAM,CAACI,KAAP,GAAe,IAAf;AACAJ,MAAAA,MAAM,CAACK,GAAP,GAAc,2CAA0CT,QAAS,EAAjE;;AACAI,MAAAA,MAAM,CAACM,MAAP,GAAgB,MAAM;AAClBlB,QAAAA,WAAW,CAAC,IAAD,CAAX;AACH,OAFD;;AAGAa,MAAAA,QAAQ,CAACM,IAAT,CAAcC,WAAd,CAA0BR,MAA1B;AACH,KAXD;;AAYA,QAAG,CAACX,KAAD,IAAUG,UAAb,EAAyB;AACrBlB,MAAAA,QAAQ,CAAC;AAAC6B,QAAAA,IAAI,EAAEhC;AAAP,OAAD,CAAR;AACAG,MAAAA,QAAQ,CAACR,cAAc,CAACS,OAAD,CAAf,CAAR;AACH,KAHD,MAGO,IAAG,CAACc,KAAK,CAACoB,MAAV,EAAkB;AACrB,UAAG,CAACC,MAAM,CAACC,MAAX,EAAkB;AACdjB,QAAAA,eAAe;AAClB,OAFD,MAEO;AACHN,QAAAA,WAAW,CAAC,IAAD,CAAX;AACH;AACJ;AAEJ,GAxBQ,EAwBN,CAACd,QAAD,EAAWC,OAAX,EAAoBiB,UAApB,EAAgCH,KAAhC,CAxBM,CAAT;;AA0BA,QAAMuB,qBAAqB,GAAIC,aAAD,IAAmB;AAC7Cf,IAAAA,OAAO,CAACC,GAAR,CAAYc,aAAZ;AACAvC,IAAAA,QAAQ,CAACP,QAAQ,CAACQ,OAAD,EAASsC,aAAT,CAAT,CAAR;AACH,GAHD;;AAMF,sBAAO;AAAA,4BACH,QAAC,aAAD;AAAe,MAAA,KAAK,MAApB;AAAqB,MAAA,KAAK,MAA1B;AAA2B,MAAA,KAAK,MAAhC;AAAiC,MAAA,KAAK;AAAtC;AAAA;AAAA;AAAA;AAAA,YADG,8BAGH;AAAA,2BAAWxB,KAAX,aAAWA,KAAX,uBAAWA,KAAK,CAAEyB,GAAlB;AAAA;AAAA;AAAA;AAAA;AAAA,YAHG,eAIH;AAAK,MAAA,SAAS,EAAC,KAAf;AAAA,8BACI;AAAK,QAAA,SAAS,EAAC,OAAf;AAAA,+BACI;AAAI,UAAA,SAAS,EAAC,YAAd;AAAA,kCACI;AAAI,YAAA,SAAS,EAAC,iBAAd;AAAA,oCACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ,eAEI;AAAA,sCACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADJ,OAC8BzB,KAD9B,aAC8BA,KAD9B,sCAC8BA,KAAK,CAAE0B,IADrC,gDAC8B,YAAaC,IAD3C;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFJ,eAKI;AAAA,sCACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADJ,OAC8B,GAD9B,eAEE;AAAG,gBAAA,IAAI,EAAG,WAAU3B,KAAX,aAAWA,KAAX,uCAAWA,KAAK,CAAE0B,IAAlB,iDAAW,aAAaE,KAAM,EAAvC;AAAA,0BAA2C5B,KAA3C,aAA2CA,KAA3C,uCAA2CA,KAAK,CAAE0B,IAAlD,iDAA2C,aAAaE;AAAxD;AAAA;AAAA;AAAA;AAAA,sBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,oBALJ,eASI;AAAA,sCACN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADM,EAEL5B,KAFK,aAELA,KAFK,uBAELA,KAAK,CAAE6B,eAAP,CAAuBC,OAFlB,QAE6B9B,KAF7B,aAE6BA,KAF7B,uBAE6BA,KAAK,CAAE6B,eAAP,CAAuBE,IAFpD,EAE0D,GAF1D,EAGL/B,KAHK,aAGLA,KAHK,uBAGLA,KAAK,CAAE6B,eAAP,CAAuBG,UAHlB,OAG+B,GAH/B,EAILhC,KAJK,aAILA,KAJK,uBAILA,KAAK,CAAE6B,eAAP,CAAuBI,OAJlB;AAAA;AAAA;AAAA;AAAA;AAAA,oBATJ,EAeHjC,KAAK,SAAL,IAAAA,KAAK,WAAL,IAAAA,KAAK,CAAEkC,WAAP,gBACC;AAAM,cAAA,SAAS,EAAG,aAAlB;AAAA,0CACgBlC,KADhB,aACgBA,KADhB,uBACgBA,KAAK,CAAEmC,WADvB;AAAA;AAAA;AAAA;AAAA;AAAA,oBADD,gBAKC;AAAK,cAAA,SAAS,EAAG,aAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBApBE;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eA0BI;AAAI,YAAA,SAAS,EAAC,iBAAd;AAAA,oCACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADA,eAEJ;AAAA,sCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,EAEGnC,KAFH,aAEGA,KAFH,uBAEGA,KAAK,CAAEoC,aAFV;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFI,EAMHpC,KAAK,SAAL,IAAAA,KAAK,WAAL,IAAAA,KAAK,CAAEoB,MAAP,gBACC;AAAK,cAAA,SAAS,EAAG,aAAjB;AAAA,qCAAwCpB,KAAK,CAACqC,MAA9C;AAAA;AAAA;AAAA;AAAA;AAAA,oBADD,gBAGC;AAAK,cAAA,SAAS,EAAG,aAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBATE;AAAA;AAAA;AAAA;AAAA;AAAA,kBA1BJ,eAuCI;AAAI,YAAA,SAAS,EAAC,iBAAd;AAAA,oCACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADA,EAEC,CAAArC,KAAK,SAAL,IAAAA,KAAK,WAAL,YAAAA,KAAK,CAAEsC,UAAP,CAAkBC,MAAlB,MAA6B,CAA7B,gBACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADG,gBAGH;AAAI,cAAA,SAAS,EAAC,YAAd;AAAA,wBACGvC,KADH,aACGA,KADH,uBACGA,KAAK,CAAEsC,UAAP,CAAkBE,GAAlB,CAAsB,CAACC,IAAD,EAAOC,KAAP,kBACrB;AAAI,gBAAA,SAAS,EAAC,iBAAd;AAAA,uCACE;AAAK,kBAAA,SAAS,EAAC,KAAf;AAAA,0CACE;AAAK,oBAAA,SAAS,EAAC,KAAf;AAAA,2CACE;AACE,sBAAA,KAAK,EAAE;AAACC,wBAAAA,KAAK,EAAE,MAAR;AAAgBC,wBAAAA,MAAM,EAAE;AAAxB,uBADT;AAEE,sBAAA,GAAG,EAAIH,IAAJ,aAAIA,IAAJ,uBAAIA,IAAI,CAAEI,KAFf;AAGE,sBAAA,GAAG,EAAEJ,IAAF,aAAEA,IAAF,uBAAEA,IAAI,CAAEd;AAHb;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,0BADF,eAQE;AAAK,oBAAA,SAAS,EAAC,KAAf;AAAA,2CACE,QAAC,OAAD;AAAS,sBAAA,EAAE,EAAG,YAAWc,IAAZ,aAAYA,IAAZ,uBAAYA,IAAI,CAAEK,OAAQ,EAAvC;AAAA,gCACGL,IADH,aACGA,IADH,uBACGA,IAAI,CAAEd;AADT;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,0BARF,eAaE;AAAK,oBAAA,SAAS,EAAC,OAAf;AAAA,+BACGc,IADH,aACGA,IADH,uBACGA,IAAI,CAAEM,QADT,UACuBN,IADvB,aACuBA,IADvB,uBACuBA,IAAI,CAAEO,KAD7B,UACwC,CAAAP,IAAI,SAAJ,IAAAA,IAAI,WAAJ,YAAAA,IAAI,CAAEM,QAAN,KAAiBN,IAAjB,aAAiBA,IAAjB,uBAAiBA,IAAI,CAAEO,KAAvB,CADxC;AAAA;AAAA;AAAA;AAAA;AAAA,0BAbF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF,iBAAqCN,KAArC;AAAA;AAAA;AAAA;AAAA,sBADD;AADH;AAAA;AAAA;AAAA;AAAA,oBALE;AAAA;AAAA;AAAA;AAAA;AAAA,kBAvCJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,cADJ,eAyEI;AAAK,QAAA,SAAS,EAAC,OAAf;AAAA,+BACA;AAAK,UAAA,SAAS,EAAE,MAAhB;AAAA,iCACE;AAAA,oCACE;AAAA,qCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBADF,eAIE;AAAA,qCACE;AAAK,gBAAA,SAAS,EAAG,KAAjB;AAAA,wCACE;AAAK,kBAAA,SAAS,EAAG,KAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AAAK,kBAAA,SAAS,EAAG,KAAjB;AAAA,kCAAyB1C,KAAzB,aAAyBA,KAAzB,uBAAyBA,KAAK,CAAEiD,UAAhC;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBAJF,eAUE;AAAA,qCACE;AAAK,gBAAA,SAAS,EAAG,KAAjB;AAAA,wCACE;AAAK,kBAAA,SAAS,EAAG,KAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AAAK,kBAAA,SAAS,EAAG,KAAjB;AAAA,kCAAyBjD,KAAzB,aAAyBA,KAAzB,uBAAyBA,KAAK,CAAEkD,aAAhC;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBAVF,eAgBE;AAAA,qCACE;AAAK,gBAAA,SAAS,EAAG,KAAjB;AAAA,wCACE;AAAK,kBAAA,SAAS,EAAG,KAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AAAK,kBAAA,SAAS,EAAG,KAAjB;AAAA,kCAAyBlD,KAAzB,aAAyBA,KAAzB,uBAAyBA,KAAK,CAAEmD,QAAhC;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBAhBF,eAsBE;AAAA,qCACE;AAAK,gBAAA,SAAS,EAAG,KAAjB;AAAA,wCACE;AAAK,kBAAA,SAAS,EAAG,KAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AAAK,kBAAA,SAAS,EAAG,KAAjB;AAAA,kCAAyBnD,KAAzB,aAAyBA,KAAzB,uBAAyBA,KAAK,CAAEoD,UAAhC;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBAtBF,EA4BG,EAACpD,KAAD,aAACA,KAAD,eAACA,KAAK,CAAEoB,MAAR,kBACG;AAAA,yBACKlB,UAAU,iBAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADnB,EAEKA,UAAU,gBAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAH,gBACP,QAAC,YAAD;AAAc,gBAAA,MAAM,EAAEF,KAAF,aAAEA,KAAF,uBAAEA,KAAK,CAAEoD,UAA7B;AAAyC,gBAAA,SAAS,EAAE7B;AAApD;AAAA;AAAA;AAAA;AAAA,sBAHR;AAAA;AAAA;AAAA;AAAA;AAAA,oBA7BN,EAqCX9B,cAAc,iBAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBArCP,EAsCGI,QAAQ,KACPA,QADO,aACPA,QADO,uBACPA,QAAQ,CAAEwD,OADH,CAAR,IAEC,EAACrD,KAAD,aAACA,KAAD,eAACA,KAAK,CAAEoB,MAAR,CAFD,IAGC,EAACpB,KAAD,aAACA,KAAD,eAACA,KAAK,CAAEkC,WAAR,CAHD,iBAIG;AAAA,qCACE;AACE,gBAAA,IAAI,EAAC,QADP;AAEE,gBAAA,SAAS,EAAC,cAFZ;AAGE,gBAAA,OAAO,EAAE9B,cAHX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBA1CN;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA,cAzEJ;AAAA;AAAA;AAAA;AAAA;AAAA,YAJG;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;AAyID;;GAjMuBrB,W;UAEHZ,W,EAEGC,W,EAECA,W,EAGLA,W,EAMCA,W;;;KAfGW,W","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { NavLink } from 'react-router-dom';\nimport CheckoutSteps from '../components/CheckoutSteps';\nimport { createOrder, deliverOrder, getOrderDetail, payOrder } from '../redux/actions/orderAction';\nimport { history } from '../utils/history/history';\nimport axios from 'axios'; \nimport { PayPalButton } from \"react-paypal-button-v2\";\nimport { ORDER_PAY_RESET } from '../redux/constants/constants';\n\nexport default function OrderScreen({match}) {\n    \n    const dispatch = useDispatch()\n    const orderId = match.params.id\n    const orderDetail = useSelector(state => state.orderDetail)\n\n    const orderDeliver = useSelector((state) => state.orderDeliver)\n  const { loading: loadingDeliver, success: successDeliver } = orderDeliver\n\n  const userLogin = useSelector((state) => state.userLogin)\n  const { userInfo } = userLogin\n\n    const [sdkReady, setSdkReady] = useState(false);\n    const {order, loading } = orderDetail;\n\n    const orderPay = useSelector(state => state.orderPay)\n\n    \n    const {loading:loadingPay, success:successPay } = orderPay;\n\n    const deliverHandler = () => {\n      dispatch(deliverOrder(order))\n    }\n\n    useEffect(() => {\n        const addPayPalScript = async () => {\n            const {data: clientId} = await axios.get('http://localhost:5000/api/config/paypal')\n            console.log(clientId);\n            const script = document.createElement('script')\n            script.type = \"text/javascript\"\n            script.async = true \n            script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`\n            script.onload = () => {\n                setSdkReady(true)\n            }\n            document.body.appendChild(script)\n        }\n        if(!order || successPay) {\n            dispatch({type: ORDER_PAY_RESET})\n            dispatch(getOrderDetail(orderId))\n        } else if(!order.isPaid) {\n            if(!window.paypal){\n                addPayPalScript()\n            } else {\n                setSdkReady(true)\n            }\n        }\n      \n    }, [dispatch, orderId, successPay, order]);\n\n    const successPaymentHandler = (paymentResult) => {\n        console.log(paymentResult);\n        dispatch(payOrder(orderId,paymentResult ))\n    }\n    \n\n  return <div>\n      <CheckoutSteps step1 step2 step3 step4/>\n      OrderScreen\n      <h1>Order {order?._id}</h1>\n      <div className=\"row\">\n          <div className=\"col-8\">\n              <ul className=\"list-group\">\n                  <li className=\"list-group-item\">\n                      <h4>Shipping</h4>\n                      <p>\n                          <strong>Name : </strong> {order?.user?.name}\n                      </p>\n                      <p> \n                          <strong>Email: </strong> {' '} \n                        <a href={`mailto: ${order?.user?.email}`}>{order?.user?.email}</a>\n                      </p>\n                      <p>\n                <strong>Address:</strong>\n                {order?.shippingAddress.address}, {order?.shippingAddress.city}{' '}\n                {order?.shippingAddress.postalCode},{' '}\n                {order?.shippingAddress.country}\n              </p>\n              {order?.isDelivered ? (\n                <div  className = \"text-danger\">\n                  Delivered on {order?.deliveredAt}\n                </div>\n              ) : (\n                <div className = \"text-danger\">Not Delivered</div>\n              )}\n\n\n                  </li>\n                  <li className=\"list-group-item\">\n                  <h4>Payment Method</h4>\n              <p>\n                <strong>Method: </strong>\n                {order?.paymentMethod}\n              </p> \n              {order?.isPaid ? (\n                <div className = \"text-danger\">Paid on {order.paidAt}</div>\n              ) : (\n                <div className = \"text-danger\">Not Paid</div>\n              )}\n\n                  </li>\n                  <li className=\"list-group-item\">\n                  <h4>Order Items</h4>\n                  {order?.orderItems.length === 0 ? (\n                <h2>Order is empty</h2>\n              ) : (\n                <ul className=\"list-group\">\n                  {order?.orderItems.map((item, index) => (\n                    <li className=\"list-group-item\" key={index}>\n                      <div className=\"row\">\n                        <div className=\"col\">\n                          <img\n                            style={{width: \"50px\", height: \"50px\"}}\n                            src=  {item?.image}\n                            alt={item?.name}\n                          />\n                        </div>\n                        <div className=\"col\">\n                          <NavLink to={`/product/${item?.product}`}>\n                            {item?.name}\n                          </NavLink>\n                        </div>\n                        <div className=\"col-4\">\n                          {item?.quantity} x ${item?.price} = ${item?.quantity * item?.price}\n                        </div>\n                      </div>\n                    </li>\n                  ))}\n                </ul>\n              )}\n                  </li>\n              </ul>\n          </div>\n          <div className=\"col-4\">\n          <div className= \"card\">\n            <ul>\n              <li>\n                <h2>Order Summary</h2>\n              </li>\n              <li>\n                <div className = \"row\">\n                  <div className = \"col\">Items</div>\n                  <div className = \"col\">${order?.itemsPrice}</div>\n                </div>\n              </li>\n              <li>\n                <div className = \"row\">\n                  <div className = \"col\">Shipping</div>\n                  <div className = \"col\">${order?.shippingPrice}</div>\n                </div>\n              </li>\n              <li>\n                <div className = \"row\">\n                  <div className = \"col\">Tax</div>\n                  <div className = \"col\">${order?.taxPrice}</div>\n                </div>\n              </li>\n              <li>\n                <div className = \"row\">\n                  <div className = \"col\">Total</div>\n                  <div className = \"col\">${order?.totalPrice}</div>\n                </div>\n              </li>\n              {!order?.isPaid && (\n                  <li>\n                      {loadingPay && <h1>Loading ...</h1>}\n                      {loadingPay ? <h1>Loading ...</h1> : (\n                          <PayPalButton amount={order?.totalPrice} onSuccess={successPaymentHandler}/>\n                      ) }\n                  </li>\n              )}\n\n{loadingDeliver && <h3>Loading ...</h3> }\n              {userInfo &&\n                userInfo?.isAdmin &&\n                !order?.isPaid &&\n                !order?.isDelivered && (\n                  <li>\n                    <button\n                      type='button'\n                      className='btn btn-dark'\n                      onClick={deliverHandler} >\n                      Mark As Delivered\n                    </button>\n                  </li>\n                )}\n\n            </ul>\n          </div>\n        </div>\n\n      </div>\n  </div>;\n}\n"]},"metadata":{},"sourceType":"module"}